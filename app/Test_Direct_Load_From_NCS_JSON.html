
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JSON to HTML</title>
<style>
    table {
            width: 100%;
            border-collapse: collapse;
        }
        th {
            background-color: #f3f2f1;
            color: black;
            padding: 10px;
        }
        tr{
            border-left: 1px solid black;
            border-right: 1px solid black;
        }
        td {
            padding: 10px;
            border-bottom: 1px solid #ddd;
            font-family: arial, sans-serif;
        }
</style>
</head>
<body>
     <div id="content"></div>
     <h1> Test table Generation </h1>
     <table id="MyTable">

        <thead>
            <tr>
                <th>FIELD</th>
                <th>VALUE</th>
            </tr>
        </thead>
    </table>
     <!-- HTML script to have a look at reading off parameters from JSON locally-->
     
     <h2> Second Table attempt: JS code to make a list of tables</h2>
     <div id="listoftables"></div>


     <script>
    

         fetch('./data/ncs_54300.JSON',{
         headers: {
        'Access-Control-Allow-Origin':'*'
        
        }}
         )
             .then(response => response.json())
             .then(jsonData => {
                 document.title = jsonData.title;

                 const contentDiv = document.getElementById('content');
                 const header = document.createElement('h1');
                 const tableDiv=document.getElementById('MyTable')
                 header.textContent = jsonData.header;                 
                 console.log(jsonData);
                 for (let itr=0; itr<jsonData.length;itr++){
                    console.log(itr)
                    var title=document.createTextNode('Course Name: '+jsonData[itr]['COURSE_NAME']);
                    var coursetype=document.createTextNode('Course type: '+jsonData[itr]['COURSE_TYPE']);
                    var distance=document.createTextNode('Distance: '+jsonData[itr]['DISTANCE']+' miles ('+jsonData[itr]['LOCATION_TOWN']+')');
                    var description=document.createTextNode('Description: '+jsonData[itr]['WHO_THIS_COURSE_IS_FOR']);
                    var duration=document.createTextNode('Course Duration: '+jsonData[itr]['DURATION']);
                    var deliverymode=document.createTextNode('Delivery Mode: '+jsonData[itr]['DURATION']);
                    var locationtown=document.createTextNode('Location: '+jsonData[itr]['LOCATION']);
                    var requirements=document.createTextNode('Requirements: '+jsonData[itr]['SKILLS_REQUIRED']);
                    var startdate=document.createTextNode('Start Date: '+jsonData[itr]['START_DATE'])
                    
                    

                    contentDiv.appendChild(title);
                    var ruler=document.createElement('hr');
                    ruler.setAttribute("width","90%");
                    contentDiv.appendChild(document.createElement('br'));
                    contentDiv.appendChild(coursetype);
                    contentDiv.appendChild(ruler);
                    
                    contentDiv.appendChild(document.createElement('br'));
                    contentDiv.appendChild(distance);
                    contentDiv.appendChild(document.createElement('br'));
                    contentDiv.appendChild(startdate);
                    contentDiv.appendChild(document.createElement('br'));
                    contentDiv.appendChild(duration);
                    contentDiv.appendChild(document.createElement('br'));
                    contentDiv.appendChild(document.createElement('br'));

                    let row = tableDiv.insertRow();
                    let v11=row.insertCell(0); // First column
                    v11.textContent="Title";
                    let v12=row.insertCell(1); // second column
                    v12.textContent=title.textContent;
                    let row2=tableDiv.insertRow();
                    let v21=row2.insertCell(0);
                    let v22=row2.insertCell(1);
                    v21.textContent='Course type';
                    v22.textContent=coursetype.textContent;
                    
                    // Each result is a table of multiple fields, so create it
                    let vartable=document.createElement('table');
                    let keys=[//'COURSE_NAME',
                        'ENTRY_REQUIREMENTS',
                        'COURSE_TYPE',
                        'DISTANCE',
                        'LOCATION_TOWN',
                        'EMPLOYER_NAME',
                        'PROVIDER_NAME',
                        'START_DATE',
                        //'WHO_THIS_COURSE_IS_FOR',
                        'DURATION'
                    ];
                    console.log("HELLO THERE")
                    let hdr=vartable.createTHead();
                    let t1=document.createElement('th');
                    t1.textContent=jsonData[itr]['COURSE_NAME'];
                    //console.log("GET ELEM 1");
                    let t2=document.createElement('th');
                    //t2.textContent=jsonData[itr]['WEBSITE']  
                    //t2.textContent="TEST URL";
                    var clink=document.createElement('a');
                    clink.href=jsonData[itr]['WEBSITE'];
                    clink.textContent='Link to course'
                    //t2.innerHTML='<a href="'+url+'">Link to course</a>'
                    
                    t2.appendChild(clink)
                    hdr.appendChild(t1);
                    hdr.appendChild(t2);
                    for (let i =0; i<keys.length;i++){
                        let tr=vartable.insertRow();
                        var name=keys[i];
                        var value=jsonData[itr][keys[i]];
                        let v0=tr.insertCell(0);
                        let b=document.createElement('bf');
                        b.textContent=name;
                        v0.appendChild(b);
                        
                        let v1=tr.insertCell(1);
                        v1.textContent=value;
                    }
                    const list_of_tables=document.getElementById('listoftables');
                    list_of_tables.appendChild(vartable);
                    list_of_tables.appendChild(document.createElement('br'));

                    
                    

                    /*
                    let govuk_table_object=document.createElement('div');
                    govuk_table_object.classList.add('month-wrapper');
                    let summary_card=document.createElement('div');
                    summary_card.classList.add('govuk-summary-card');
                    let summary_card_title_wrapper=document.createElement('div');
                    summary_card_title_wrapper.classList.add('govuk-summary-card__title-wrapper');
                    let summary_card_title=document.createElement('h2');
                    summary_card_title.classList.add('govuk-summary-card__title');

                    summary_card_title.text=jsonData[itr]['COURSE_NAME'];
                    //start from the innermost node outward
                    summary_card_title_wrapper.appendChild(summary_card_title);
                    */

                    
                 }
                
                console.log('HELLO')
                console.log(contentDiv)
                console.log(contentDiv)
             })
             .catch(error => console.error('Error fetching JSON:', error));
     </script>
 </body>
 </html>
 


